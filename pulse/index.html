<!DOCTYPE html>
<html>
<head>
  <title>Pulse</title>
  <meta charset="utf-8">
  <style>
    body {font-family: PingFangSC-Light;}
  </style>
</head>
<body>
  <div>Rate: <span id="rate">0</span></div>
  <div>
    <button data-target="100" data-duration="20">100, 20s</button>
  </div>

  <script src='../libs/geometry-utils.js'></script>
  <script src="../libs/jquery.min.js"></script>
  <script type="module">
    import Pulse from './pulse.js'
    import PulseDetector from './pulse-detector.js'

    const pulse = new Pulse()
    const pulseDetector = new PulseDetector()

    pulse.onPulse(_ => {
      console.log('Boom!')
      pulseDetector.detect()
    })

    GeometryUtils.setIntervalCustom(_ => {
      $('#rate').text(pulseDetector.getRate())
    }, 1000)

    $('[data-target][data-duration]').on('click', function () {
      const target = Number($(this).data('target'))
      const duration = Number($(this).data('duration'))
      pulse.changeRate(target, duration)
    })
  </script>
</body>
</html>
